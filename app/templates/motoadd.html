{% extends 'base.html' %}

{% block content %}

<div class="p-4 mx-auto max-w-7xl sm:p-6 lg:p-8">
    <!-- Header -->
    <div class="pb-6 mb-6">
        <a href="{% url 'garage' %}" class="text-sm text-orange-400 hover:underline">&larr; Volver al Garaje</a>
        <h2 class="mt-2 text-3xl font-bold">Agregar Nueva Motocicleta</h2>
        <p class="text-gray-400">Ingresa los detalles de tu máquina para comenzar el seguimiento.</p>
    </div>

    <!-- Error Alert -->
    {% if error %}
    <div class="p-4 mb-6 text-red-200 bg-red-900 border border-red-700 rounded-lg" role="alert">
        <span class="font-medium">Error:</span> {{ error }}
    </div>
    {% endif %}

    <!-- Add Motorcycle Form -->
    <!-- IMPORTANTE: enctype es necesario para subir archivos (fotos) -->
    <form action="{% url 'motoadd' %}" method="POST" enctype="multipart/form-data" class="p-6 space-y-6 bg-gray-800 rounded-xl border border-gray-700">
        {% csrf_token %}
        
        <!-- Form Fields Grid -->
        <div class="grid grid-cols-1 gap-6 sm:grid-cols-2">
            
            <!-- Marca -->
            <div>
                <label for="make" class="block text-sm font-medium text-gray-300">Marca</label>
                <input type="text" name="make" id="make" required placeholder="Ej: Bajaj, Yamaha, Honda" 
                       class="block w-full px-3 py-2 mt-1 text-white bg-gray-700 border border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-orange-500 focus:border-orange-500 sm:text-sm transition-colors">
            </div>

            <!-- Modelo -->
            <div>
                <label for="model" class="block text-sm font-medium text-gray-300">Modelo</label>
                <input type="text" name="model" id="model" required placeholder="Ej: Pulsar NS200" 
                       class="block w-full px-3 py-2 mt-1 text-white bg-gray-700 border border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-orange-500 focus:border-orange-500 sm:text-sm transition-colors">
                <p class="mt-1 text-xs text-gray-500">Intenta usar el nombre oficial para que la IA lo reconozca mejor.</p>
            </div>

            <!-- Año -->
            <div>
                <label for="year" class="block text-sm font-medium text-gray-300">Año</label>
                <input type="number" name="year" id="year" required placeholder="Ej: 2023" min="1900" max="2099"
                       class="block w-full px-3 py-2 mt-1 text-white bg-gray-700 border border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-orange-500 focus:border-orange-500 sm:text-sm transition-colors">
            </div>

            <!-- Kilometraje -->
            <div>
                <label for="mileage" class="block text-sm font-medium text-gray-300">Kilometraje Actual</label>
                <div class="relative mt-1 rounded-md shadow-sm">
                    <input type="number" name="mileage" id="mileage" required placeholder="Ej: 12500" min="0"
                           class="block w-full px-3 py-2 text-white bg-gray-700 border border-gray-600 rounded-md focus:outline-none focus:ring-orange-500 focus:border-orange-500 sm:text-sm transition-colors">
                    <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                        <span class="text-gray-400 sm:text-sm">km</span>
                    </div>
                </div>
            </div>
            
            <!-- Apodo (Opcional) -->
            <div class="sm:col-span-2">
                <label for="nickname" class="block text-sm font-medium text-gray-300">Apodo (Opcional)</label>
                <input type="text" name="nickname" id="nickname" placeholder="Ej: La Bestia Negra" 
                       class="block w-full px-3 py-2 mt-1 text-white bg-gray-700 border border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-orange-500 focus:border-orange-500 sm:text-sm transition-colors">
            </div>

            <!-- Subir Foto -->
            <div class="sm:col-span-2">
                <label class="block text-sm font-medium text-gray-300">Foto de la Motocicleta</label>
                <div class="flex items-center justify-center w-full mt-2">
                    <label for="photo-upload" class="relative flex flex-col items-center justify-center w-full h-40 border-2 border-gray-600 border-dashed rounded-lg cursor-pointer hover:bg-gray-700 hover:border-gray-500 transition-all group">
                        <div class="flex flex-col items-center justify-center pt-5 pb-6">
                            <svg class="w-10 h-10 mb-3 text-gray-400 group-hover:text-orange-400 transition-colors" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 16">
                                <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 13h3a3 3 0 0 0 0-6h-.025A5.56 5.56 0 0 0 16 6.5 5.5 5.5 0 0 0 5.207 5.021C5.137 5.017 5.071 5 5 5a4 4 0 0 0 0 8h2.167M10 15V6m0 0L8 8m2-2 2 2"/>
                            </svg>
                            <p class="mb-2 text-sm text-gray-400"><span class="font-semibold text-orange-400">Haz clic para subir</span> o arrastra y suelta</p>
                            <p class="text-xs text-gray-500">PNG, JPG o JPEG (Máx. 800x400px)</p>
                            <!-- Script simple para mostrar nombre del archivo seleccionado -->
                            <p id="file-name" class="mt-2 text-sm text-green-400 font-medium"></p>
                        </div>
                        <input id="photo-upload" name="photo" type="file" class="hidden" accept="image/*" onchange="document.getElementById('file-name').textContent = this.files[0].name">
                    </label>
                </div> 
            </div>

        </div>

        <!-- Botones de Acción -->
        <div class="pt-6 border-t border-gray-700">
            <div class="flex justify-end gap-3">
                <a href="{% url 'garage' %}" class="px-4 py-2 text-sm font-medium text-gray-300 bg-gray-700 border border-transparent rounded-md shadow-sm hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-800 focus:ring-gray-500 transition-colors">
                    Cancelar
                </a>
                <button type="submit" class="inline-flex justify-center px-6 py-2 text-sm font-medium text-white bg-orange-500 border border-transparent rounded-md shadow-sm hover:bg-orange-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-800 focus:ring-orange-500 transition-colors">
                    Guardar Motocicleta
                </button>
            </div>
        </div>
    </form>
</div>

{% endblock %}